@inherits LayoutComponentBase
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<SharedResources> Localizer
@inject NavigationManager NavigationManager
<div class="mobile-layout">
    <div class="mobile-header">
        <h1>@Localizer["AppName"]</h1>
        <div class="subtitle">@Localizer["MobileInspection"]</div>
    </div>

    <div class="mobile-content">
        @Body
    </div>

    <div class="mobile-footer">
        <button type="button" @onclick="NavigateHome" class="@GetActiveClass("/mobile")">
            <span class="icon">üè†</span>
            <span>@Localizer["Home"]</span>
        </button>
        <button type="button" @onclick="NavigateRounds" class="@GetActiveClass("/mobile/rounds")">
            <span class="icon">üìã</span>
            <span>@Localizer["Rounds"]</span>
        </button>
        <button type="button" @onclick="Logout">
            <span class="icon">üö™</span>
            <span>@Localizer["Logout"]</span>
        </button>
    </div>
</div>

@code {
    private string GetActiveClass(string path)
    {
        var currentPath = "/" + NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        // For exact match on home, check if it's exactly /mobile
        if (path == "/mobile")
        {
            return (currentPath == "/mobile" || currentPath == "/mobile/") ? "active" : "";
        }
        return currentPath.StartsWith(path) ? "active" : "";
    }

    private void NavigateHome()
    {
        NavigationManager.NavigateTo("/mobile", forceLoad: false);
    }

    private void NavigateRounds()
    {
        NavigationManager.NavigateTo("/mobile/rounds", forceLoad: false);
    }

    private void Logout()
    {
        NavigationManager.NavigateTo("/Account/Logout", forceLoad: true);
    }
}
